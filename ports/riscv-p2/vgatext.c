// automatically generated by spin2cpp v3.9.28-beta-9a18aa43 on Sat Jul 13 06:25:05 2019
// command line: /home/ersmith/Parallax/spin2cpp/build/spin2cpp -I.. --p2 --ccode vgatext.spin 

//
// clock frequency settings
// for 800x600 we use a 40 MHz pixel clock
// which x4 gives a 160 MHz system clock
// or x5 gives a 200 MHz system clock
// those are probably good choices for running
// with this
//
#include <string.h>
#include <propeller.h>
#include "vgatext.h"

#if defined(__GNUC__)
#define INLINE__ static inline
#else
#define INLINE__ static
#ifndef __FLEXC__
#define waitcnt(n) _waitcnt(n)
#define coginit(id, code, par) _coginit((unsigned)(par)>>2, (unsigned)(code)>>2, id)
#define cognew(code, par) coginit(0x8, (code), (par))
#define cogstop(i) _cogstop(i)
#endif /* __FLEXC__ */
#endif

INLINE__ int32_t Min__(int32_t a, int32_t b) { return a < b ? a : b; }
INLINE__ int32_t Max__(int32_t a, int32_t b) { return a > b ? a : b; }
INLINE__ int32_t Shr__(uint32_t a, uint32_t b) { return (a>>b); }
static  void vgatext_init_terminal(vgatext *self);
static  void vgatext_reset_graphics_state(vgatext *self);
static  void vgatext_copy_line(vgatext *self, int32_t dest, int32_t src);
static  void vgatext_scroll_up(vgatext *self);
static  void vgatext_scroll_down(vgatext *self);
static  void vgatext_checkposition(vgatext *self);
static  void vgatext_handle_esc(vgatext *self, int32_t c);
static  int32_t vgatext_defaultval(int32_t arg, int32_t v);
static  void vgatext_handle_csi_start(vgatext *self, int32_t c);
static  void vgatext_handle_csi(vgatext *self, int32_t c);
static  void vgatext_handle_priv(vgatext *self, int32_t c);
static  int32_t vgatext_setcursorvisible(vgatext *self, int32_t yesno);
static  void vgatext_concealcursor(vgatext *self);
static  void vgatext_revealcursor(vgatext *self);
static  void vgatext_clear(vgatext *self, int32_t a, int32_t b);
static  void vgatext_clear_in_display(vgatext *self, int32_t n);
static  void vgatext_clear_in_line(vgatext *self, int32_t n);
static  int32_t vgatext_fetcharg(vgatext *self, int32_t i);
static  void vgatext_set_graphic_rendition(vgatext *self, int32_t i);
static  int32_t vgatext_ansicolor(vgatext *self, int32_t n);
static  int32_t vgatext_sixcolor(int32_t x);
static  Tuple2__ vgatext_getargcolor(vgatext *self, int32_t i);
static  int32_t vgatext_calcscale(int32_t a, int32_t b);

static char dat[] = {
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x66, 0x07, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x00, 
  0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x18, 0x18, 0x36, 0x00, 0x00, 0x36, 0x36, 0x00, 0x36, 0x36, 0x18, 0x00, 
  0x18, 0x18, 0x00, 0x18, 0x00, 0x18, 0x18, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 
  0x18, 0x00, 0x00, 0x36, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0xff, 0x00, 0x0f, 0xf0, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x66, 0x07, 0x3c, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 
  0x00, 0x18, 0x66, 0x00, 0x18, 0x00, 0x00, 0x18, 0x30, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x03, 0x3c, 0x08, 0x00, 
  0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x18, 0x07, 0x4e, 0x00, 
  0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x18, 0x00, 0x66, 0x00, 
  0x18, 0x00, 0x00, 0x18, 0x00, 0x00, 0x18, 0x00, 0x00, 0x66, 0x66, 0x00, 0x00, 0x00, 0x3f, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x3b, 0x3c, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 
  0x11, 0xaa, 0xee, 0x18, 0x18, 0x18, 0x36, 0x00, 0x00, 0x36, 0x36, 0x00, 0x36, 0x36, 0x18, 0x00, 
  0x18, 0x18, 0x00, 0x18, 0x00, 0x18, 0x18, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 
  0x18, 0x00, 0x00, 0x36, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0xff, 0x00, 0x0f, 0xf0, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x3c, 0x00, 0x00, 0xc0, 0x00, 0x1c, 0x00, 0x00, 
  0x00, 0x3c, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x66, 0x01, 0x66, 0x00, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 
  0x00, 0x18, 0x66, 0x36, 0x18, 0x60, 0x1c, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 
  0x1c, 0x18, 0x3c, 0x3c, 0x30, 0x7e, 0x38, 0x7e, 0x3c, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 
  0x3e, 0x18, 0x3e, 0x3c, 0x1e, 0x7e, 0x7e, 0x3c, 0x66, 0x7e, 0x60, 0x63, 0x06, 0x63, 0x63, 0x3c, 
  0x3e, 0x3c, 0x3e, 0x3c, 0x7e, 0x66, 0x66, 0x63, 0xc3, 0xc3, 0x7e, 0x0c, 0x06, 0x30, 0x1c, 0x00, 
  0x18, 0x00, 0x06, 0x00, 0x60, 0x00, 0x78, 0x00, 0x06, 0x18, 0x30, 0x06, 0x1e, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x0c, 0x6b, 0x00, 
  0x3c, 0x66, 0x30, 0x3c, 0x66, 0x0c, 0x3c, 0x00, 0x3c, 0x66, 0x0c, 0x66, 0x3c, 0x0c, 0x00, 0x00, 
  0x00, 0x00, 0xfc, 0x3c, 0x66, 0x0c, 0x3c, 0x00, 0x66, 0x00, 0x00, 0x18, 0x1c, 0xc3, 0x66, 0x00, 
  0x30, 0x30, 0x30, 0x30, 0x6e, 0x00, 0x60, 0x00, 0x18, 0x00, 0x00, 0x66, 0x66, 0x18, 0x00, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x18, 0x18, 0x36, 0x00, 0x00, 0x36, 0x36, 0x00, 0x36, 0x36, 0x18, 0x00, 
  0x18, 0x18, 0x00, 0x18, 0x00, 0x18, 0x18, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 
  0x18, 0x00, 0x00, 0x36, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0xff, 0x00, 0x0f, 0xf0, 0x00, 
  0x00, 0x1e, 0x7e, 0x00, 0x7f, 0x00, 0x00, 0x00, 0x08, 0x3e, 0x00, 0x7f, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x70, 0x18, 0x00, 0x00, 0x66, 0x00, 0x00, 0xc0, 0x00, 0x36, 0x7e, 0x00, 
  0x00, 0x42, 0x7e, 0x36, 0x08, 0x08, 0x08, 0x00, 0xff, 0x3c, 0x00, 0x00, 0x00, 0x18, 0xfe, 0x00, 
  0x00, 0x00, 0x00, 0x66, 0x01, 0x06, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 
  0x00, 0x18, 0x66, 0x36, 0x3c, 0x63, 0x36, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 
  0x36, 0x1c, 0x66, 0x66, 0x38, 0x06, 0x0c, 0x60, 0x66, 0x66, 0x18, 0x18, 0x60, 0x00, 0x06, 0x66, 
  0x63, 0x3c, 0x66, 0x66, 0x36, 0x06, 0x06, 0x66, 0x66, 0x18, 0x60, 0x63, 0x06, 0x77, 0x63, 0x66, 
  0x66, 0x66, 0x66, 0x66, 0x18, 0x66, 0x66, 0x63, 0xc3, 0xc3, 0x60, 0x0c, 0x06, 0x30, 0x36, 0x00, 
  0x30, 0x00, 0x06, 0x00, 0x60, 0x00, 0x0c, 0x00, 0x06, 0x18, 0x30, 0x06, 0x18, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x0c, 0x39, 0x00, 
  0x66, 0x66, 0x18, 0x66, 0x66, 0x18, 0x66, 0x00, 0x66, 0x66, 0x18, 0x66, 0x66, 0x18, 0x18, 0x00, 
  0x7e, 0x00, 0x3e, 0x66, 0x66, 0x18, 0x66, 0x00, 0x66, 0x3c, 0x66, 0x18, 0x36, 0xc3, 0x66, 0x00, 
  0x18, 0x18, 0x18, 0x18, 0x3b, 0x63, 0x60, 0x00, 0x00, 0x00, 0x00, 0x67, 0x67, 0x00, 0x00, 0x00, 
  0x11, 0xaa, 0x77, 0x18, 0x18, 0x18, 0x36, 0x00, 0x00, 0x36, 0x36, 0x00, 0x36, 0x36, 0x18, 0x00, 
  0x18, 0x18, 0x00, 0x18, 0x00, 0x18, 0x18, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 
  0x18, 0x00, 0x00, 0x36, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0xff, 0x00, 0x0f, 0xf0, 0x00, 
  0x00, 0x33, 0x06, 0x00, 0x03, 0x00, 0x00, 0x00, 0x3e, 0x63, 0x3e, 0x03, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0xd8, 0x18, 0x00, 0x00, 0x66, 0x00, 0x00, 0x60, 0x1e, 0x30, 0x7e, 0x00, 
  0x00, 0x81, 0xff, 0x7f, 0x1c, 0x1c, 0x1c, 0x00, 0xe7, 0x66, 0x00, 0x00, 0x00, 0x38, 0xc6, 0x00, 
  0x03, 0xc0, 0x00, 0x66, 0x77, 0x0c, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x00, 
  0x00, 0x18, 0x00, 0x36, 0x66, 0x33, 0x36, 0x0c, 0x0c, 0x30, 0x66, 0x18, 0x00, 0x00, 0x00, 0x30, 
  0x63, 0x1e, 0x66, 0x66, 0x3c, 0x06, 0x06, 0x60, 0x66, 0x66, 0x18, 0x18, 0x30, 0x00, 0x0c, 0x60, 
  0x63, 0x66, 0x66, 0x66, 0x66, 0x06, 0x06, 0x66, 0x66, 0x18, 0x60, 0x33, 0x06, 0x77, 0x67, 0x66, 
  0x66, 0x66, 0x66, 0x66, 0x18, 0x66, 0x66, 0x63, 0x66, 0x66, 0x60, 0x0c, 0x0c, 0x30, 0x36, 0x00, 
  0x60, 0x00, 0x06, 0x00, 0x60, 0x00, 0x0c, 0x00, 0x06, 0x00, 0x00, 0x06, 0x18, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x66, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 
  0x06, 0x00, 0x3f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x7e, 0x36, 0x66, 0x3e, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x63, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x36, 0x36, 0x00, 0x00, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x18, 0x18, 0x36, 0x00, 0x00, 0x36, 0x36, 0x00, 0x36, 0x36, 0x18, 0x00, 
  0x18, 0x18, 0x00, 0x18, 0x00, 0x18, 0x18, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 
  0x18, 0x00, 0x00, 0x36, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0xff, 0x00, 0x0f, 0xf0, 0x00, 
  0x00, 0x33, 0x06, 0x00, 0x06, 0x00, 0x00, 0x00, 0x6b, 0x63, 0x63, 0x03, 0x00, 0x00, 0x00, 0x00, 
  0x7e, 0x18, 0x0c, 0x30, 0xd8, 0x18, 0x18, 0x00, 0x3c, 0x00, 0x00, 0x60, 0x36, 0x18, 0x7e, 0x00, 
  0x00, 0xa5, 0xdb, 0x7f, 0x1c, 0x1c, 0x3e, 0x00, 0xe7, 0x66, 0x00, 0x00, 0x00, 0x78, 0xc6, 0x00, 
  0x0f, 0xf0, 0x00, 0x66, 0x77, 0x1c, 0x00, 0x00, 0x18, 0x00, 0x10, 0x08, 0x00, 0x24, 0x1c, 0x00, 
  0x00, 0x18, 0x00, 0x7f, 0x06, 0x33, 0x1c, 0x00, 0x0c, 0x30, 0x66, 0x18, 0x00, 0x00, 0x00, 0x30, 
  0x63, 0x18, 0x60, 0x60, 0x36, 0x06, 0x06, 0x60, 0x66, 0x66, 0x18, 0x18, 0x18, 0x7e, 0x18, 0x30, 
  0x63, 0x66, 0x66, 0x06, 0x66, 0x06, 0x06, 0x06, 0x66, 0x18, 0x60, 0x33, 0x06, 0x7f, 0x67, 0x66, 
  0x66, 0x66, 0x66, 0x06, 0x18, 0x66, 0x66, 0x63, 0x3c, 0x66, 0x30, 0x0c, 0x0c, 0x30, 0x63, 0x00, 
  0x00, 0x00, 0x06, 0x00, 0x60, 0x00, 0x0c, 0x00, 0x06, 0x00, 0x00, 0x06, 0x18, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x00, 
  0x06, 0x00, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x7e, 0x06, 0x66, 0x46, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x67, 0x66, 0x00, 0x18, 0x00, 0x00, 0x36, 0x36, 0x18, 0xcc, 0x00, 
  0x11, 0xaa, 0xee, 0x18, 0x18, 0x18, 0x36, 0x00, 0x00, 0x36, 0x36, 0x00, 0x36, 0x36, 0x18, 0x00, 
  0x18, 0x18, 0x00, 0x18, 0x00, 0x18, 0x18, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 0x36, 0x00, 
  0x18, 0x00, 0x00, 0x36, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0xff, 0x00, 0x0f, 0xf0, 0x00, 
  0x00, 0x33, 0x06, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x6b, 0x63, 0x63, 0x06, 0x6e, 0x00, 0x00, 0x00, 
  0x00, 0x18, 0x18, 0x18, 0xd8, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x60, 0x36, 0x0c, 0x7e, 0x00, 
  0x00, 0x81, 0xff, 0x7f, 0x3e, 0x2a, 0x7f, 0x00, 0xc3, 0x42, 0x55, 0x00, 0x00, 0xd8, 0xc6, 0x00, 
  0x3f, 0xfc, 0x00, 0x66, 0x14, 0x36, 0x00, 0x00, 0x18, 0x00, 0x30, 0x0c, 0x7f, 0x66, 0x1c, 0x00, 
  0x00, 0x18, 0x00, 0x36, 0x0c, 0x18, 0x0c, 0x00, 0x0c, 0x30, 0x3c, 0x18, 0x00, 0x00, 0x00, 0x18, 
  0x73, 0x18, 0x60, 0x60, 0x33, 0x3e, 0x3e, 0x30, 0x6e, 0x66, 0x00, 0x00, 0x0c, 0x00, 0x30, 0x18, 
  0x7b, 0x66, 0x36, 0x06, 0x66, 0x06, 0x3e, 0x06, 0x66, 0x18, 0x60, 0x1b, 0x06, 0x6b, 0x6f, 0x66, 
  0x66, 0x66, 0x66, 0x0c, 0x18, 0x66, 0x66, 0x63, 0x18, 0x3c, 0x30, 0x0c, 0x18, 0x30, 0x63, 0x00, 
  0x00, 0x3c, 0x3e, 0x3c, 0x7c, 0x3c, 0x7e, 0x7c, 0x3e, 0x1e, 0x30, 0x66, 0x18, 0x33, 0x3e, 0x3c, 
  0x3e, 0x7c, 0x3e, 0x7c, 0x7e, 0x66, 0x66, 0x63, 0x63, 0x66, 0x7e, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x06, 0x66, 0x3c, 0x3c, 0x3c, 0x3c, 0x3c, 0x00, 0x3c, 0x3c, 0x3c, 0x1c, 0x1c, 0x1c, 0x66, 0x00, 
  0x06, 0x7e, 0x33, 0x3c, 0x3c, 0x3c, 0x66, 0x00, 0x66, 0x66, 0x66, 0x1b, 0x06, 0x3c, 0x66, 0x00, 
  0x3c, 0x1c, 0x3c, 0x66, 0x3e, 0x6f, 0x66, 0x00, 0x0c, 0x00, 0x7f, 0x18, 0x18, 0x18, 0x66, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x18, 0x1f, 0x36, 0x00, 0x1f, 0x37, 0x36, 0x3f, 0x37, 0x3f, 0x1f, 0x00, 
  0x18, 0x18, 0x00, 0x18, 0x00, 0x18, 0xf8, 0x00, 0xf6, 0xfe, 0xf7, 0xff, 0xf6, 0xff, 0xf7, 0x00, 
  0xf8, 0xff, 0x00, 0xfe, 0xf8, 0xf8, 0x00, 0x00, 0xff, 0x18, 0x00, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x6e, 0x1b, 0x06, 0x7f, 0x18, 0x7e, 0x66, 0x00, 0x6b, 0x63, 0x63, 0x0c, 0xdb, 0x3e, 0x7c, 0x00, 
  0x00, 0x18, 0x30, 0x0c, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x36, 0x06, 0x7e, 0x00, 
  0x00, 0x81, 0xff, 0x7f, 0x7f, 0x7f, 0x7f, 0x00, 0xc3, 0x42, 0x55, 0x00, 0x00, 0x18, 0xc6, 0x00, 
  0xff, 0xff, 0x00, 0x66, 0x14, 0x66, 0x00, 0x00, 0x18, 0x00, 0x7f, 0xfe, 0x60, 0xff, 0x1c, 0x00, 
  0x00, 0x18, 0x00, 0x36, 0x18, 0x18, 0x5e, 0x00, 0x0c, 0x30, 0xff, 0x7e, 0x00, 0x7e, 0x00, 0x18, 
  0x6b, 0x18, 0x30, 0x38, 0x33, 0x60, 0x66, 0x30, 0x3c, 0x7c, 0x00, 0x00, 0x06, 0x00, 0x60, 0x18, 
  0x7b, 0x7e, 0x1e, 0x06, 0x66, 0x3e, 0x06, 0x76, 0x7e, 0x18, 0x60, 0x0f, 0x06, 0x6b, 0x7f, 0x66, 
  0x3e, 0x66, 0x3e, 0x18, 0x18, 0x66, 0x66, 0x6b, 0x18, 0x18, 0x18, 0x0c, 0x18, 0x30, 0x00, 0x00, 
  0x00, 0x60, 0x66, 0x66, 0x66, 0x66, 0x0c, 0x66, 0x66, 0x18, 0x30, 0x66, 0x18, 0x7f, 0x66, 0x66, 
  0x66, 0x66, 0x66, 0x06, 0x0c, 0x66, 0x66, 0x63, 0x63, 0x66, 0x60, 0x0f, 0x18, 0x78, 0x00, 0x00, 
  0x06, 0x66, 0x66, 0x60, 0x60, 0x60, 0x60, 0x00, 0x66, 0x66, 0x66, 0x18, 0x18, 0x18, 0x66, 0x00, 
  0x3e, 0xd8, 0x7f, 0x66, 0x66, 0x66, 0x66, 0x00, 0x66, 0x66, 0x66, 0x1b, 0x0f, 0x18, 0xf6, 0x00, 
  0x60, 0x18, 0x66, 0x66, 0x66, 0x7b, 0x7c, 0x00, 0x0c, 0x00, 0x60, 0x18, 0x18, 0x18, 0x33, 0x00, 
  0x11, 0xaa, 0x77, 0x18, 0x1f, 0x18, 0x37, 0x00, 0x18, 0x30, 0x36, 0x30, 0x30, 0x3f, 0x18, 0x00, 
  0xf8, 0xff, 0xff, 0xf8, 0xff, 0xff, 0x18, 0x00, 0x06, 0x06, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 
  0xff, 0x00, 0xff, 0xfe, 0x18, 0x18, 0xfe, 0x00, 0x18, 0x1f, 0xf8, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x73, 0x33, 0x06, 0x36, 0x30, 0x33, 0x66, 0x00, 0x6b, 0x7f, 0x63, 0x18, 0xdb, 0x03, 0x06, 0x00, 
  0x7e, 0x7e, 0x60, 0x06, 0x18, 0x18, 0x7e, 0x00, 0x00, 0x00, 0x18, 0x60, 0x36, 0x3e, 0x7e, 0x00, 
  0x00, 0xbd, 0xc3, 0x3e, 0x3e, 0x7f, 0x7f, 0x00, 0xc3, 0x42, 0x55, 0x00, 0x00, 0x18, 0xc6, 0x00, 
  0x3f, 0xfc, 0x00, 0x66, 0x77, 0x6c, 0x7e, 0x00, 0x18, 0x00, 0x7f, 0xfe, 0x60, 0xff, 0x3e, 0x00, 
  0x00, 0x18, 0x00, 0x36, 0x30, 0x0c, 0x7b, 0x00, 0x0c, 0x30, 0x3c, 0x18, 0x00, 0x00, 0x00, 0x0c, 
  0x67, 0x18, 0x18, 0x60, 0x7f, 0x60, 0x66, 0x18, 0x76, 0x60, 0x00, 0x00, 0x0c, 0x00, 0x30, 0x18, 
  0x7b, 0x66, 0x36, 0x06, 0x66, 0x06, 0x06, 0x66, 0x66, 0x18, 0x60, 0x1b, 0x06, 0x63, 0x7b, 0x66, 
  0x06, 0x66, 0x36, 0x30, 0x18, 0x66, 0x66, 0x6b, 0x18, 0x18, 0x0c, 0x0c, 0x30, 0x30, 0x00, 0x00, 
  0x00, 0x7c, 0x66, 0x06, 0x66, 0x66, 0x0c, 0x66, 0x66, 0x18, 0x30, 0x36, 0x18, 0x6b, 0x66, 0x66, 
  0x66, 0x66, 0x66, 0x06, 0x0c, 0x66, 0x66, 0x6b, 0x36, 0x66, 0x30, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x06, 0x66, 0x66, 0x7c, 0x7c, 0x7c, 0x7c, 0x00, 0x66, 0x66, 0x66, 0x18, 0x18, 0x18, 0x7e, 0x00, 
  0x06, 0xd8, 0x33, 0x66, 0x66, 0x66, 0x66, 0x00, 0x66, 0x66, 0x66, 0x1b, 0x06, 0x7e, 0x66, 0x00, 
  0x7c, 0x18, 0x66, 0x66, 0x66, 0x73, 0x00, 0x00, 0x06, 0x00, 0x60, 0x0c, 0x0c, 0x18, 0x66, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x1f, 0x1f, 0x37, 0x00, 0x1f, 0x37, 0x36, 0x37, 0x3f, 0x00, 0x1f, 0x00, 
  0xf8, 0xff, 0xff, 0xf8, 0xff, 0xff, 0xf8, 0x00, 0xfe, 0xf6, 0xff, 0xf7, 0xf6, 0xff, 0xf7, 0x00, 
  0xff, 0xff, 0xff, 0x00, 0xf8, 0xf8, 0xfe, 0x00, 0xff, 0x1f, 0xf8, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x63, 0x63, 0x06, 0x36, 0x18, 0x63, 0x66, 0x00, 0x6b, 0x63, 0x63, 0x3e, 0xdb, 0x3b, 0x06, 0x00, 
  0x00, 0x18, 0x30, 0x0c, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x7e, 0x00, 
  0x00, 0x99, 0xe7, 0x3e, 0x1c, 0x2a, 0x1c, 0x00, 0xc3, 0x42, 0x55, 0x00, 0x00, 0x1e, 0xe6, 0x00, 
  0x0f, 0xf0, 0x00, 0x66, 0x77, 0x38, 0x7e, 0x00, 0x18, 0x00, 0x30, 0x0c, 0x60, 0x66, 0x3e, 0x00, 
  0x00, 0x00, 0x00, 0x7f, 0x60, 0x0c, 0x33, 0x00, 0x0c, 0x30, 0x66, 0x18, 0x00, 0x00, 0x00, 0x0c, 
  0x63, 0x18, 0x0c, 0x60, 0x30, 0x60, 0x66, 0x18, 0x66, 0x60, 0x00, 0x00, 0x18, 0x7e, 0x18, 0x00, 
  0x3b, 0x66, 0x66, 0x06, 0x66, 0x06, 0x06, 0x66, 0x66, 0x18, 0x60, 0x33, 0x06, 0x63, 0x73, 0x66, 
  0x06, 0x66, 0x66, 0x60, 0x18, 0x66, 0x3c, 0x7f, 0x3c, 0x18, 0x0c, 0x0c, 0x30, 0x30, 0x00, 0x00, 
  0x00, 0x66, 0x66, 0x06, 0x66, 0x7e, 0x0c, 0x66, 0x66, 0x18, 0x30, 0x1e, 0x18, 0x6b, 0x66, 0x66, 
  0x66, 0x66, 0x06, 0x3c, 0x0c, 0x66, 0x66, 0x6b, 0x1c, 0x66, 0x18, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x06, 0x66, 0x7e, 0x66, 0x66, 0x66, 0x66, 0x00, 0x7e, 0x7e, 0x7e, 0x18, 0x18, 0x18, 0x66, 0x00, 
  0x06, 0xfe, 0x33, 0x66, 0x66, 0x66, 0x66, 0x00, 0x66, 0x66, 0x66, 0x1b, 0x06, 0x18, 0x66, 0x00, 
  0x66, 0x18, 0x66, 0x66, 0x66, 0x63, 0x7e, 0x00, 0x06, 0x00, 0x60, 0x0c, 0x4c, 0x18, 0xcc, 0x00, 
  0x11, 0xaa, 0xee, 0x18, 0x18, 0x18, 0x36, 0x00, 0x18, 0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x36, 0x00, 0x36, 0x36, 0x00, 0x36, 0x00, 
  0x00, 0x18, 0x36, 0x00, 0x00, 0x18, 0x36, 0x00, 0x18, 0x00, 0x18, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x63, 0x63, 0x06, 0x36, 0x0c, 0x63, 0x66, 0x00, 0x3e, 0x63, 0x77, 0x63, 0x76, 0x6b, 0x3c, 0x00, 
  0x00, 0x18, 0x18, 0x18, 0x18, 0x1b, 0x18, 0x00, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x7e, 0x00, 
  0x00, 0x81, 0xff, 0x1c, 0x1c, 0x08, 0x1c, 0x00, 0xe7, 0x66, 0x00, 0x00, 0x00, 0x1f, 0xe7, 0x00, 
  0x03, 0xc0, 0x00, 0x00, 0x40, 0x30, 0x7e, 0x00, 0x18, 0x00, 0x10, 0x08, 0x60, 0x24, 0x3e, 0x00, 
  0x00, 0x00, 0x00, 0x36, 0x66, 0x66, 0x33, 0x00, 0x0c, 0x30, 0x66, 0x18, 0x1c, 0x00, 0x18, 0x06, 
  0x63, 0x18, 0x06, 0x66, 0x30, 0x66, 0x66, 0x18, 0x66, 0x60, 0x18, 0x1c, 0x30, 0x00, 0x0c, 0x00, 
  0x03, 0x66, 0x66, 0x66, 0x66, 0x06, 0x06, 0x66, 0x66, 0x18, 0x66, 0x33, 0x06, 0x63, 0x73, 0x66, 
  0x06, 0x66, 0x66, 0x66, 0x18, 0x66, 0x3c, 0x77, 0x66, 0x18, 0x06, 0x0c, 0x60, 0x30, 0x00, 0x00, 
  0x00, 0x66, 0x66, 0x06, 0x66, 0x06, 0x0c, 0x66, 0x66, 0x18, 0x30, 0x36, 0x18, 0x6b, 0x66, 0x66, 
  0x66, 0x66, 0x06, 0x60, 0x0c, 0x66, 0x66, 0x6b, 0x36, 0x66, 0x0c, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x66, 0x66, 0x06, 0x66, 0x66, 0x66, 0x66, 0x00, 0x06, 0x06, 0x06, 0x18, 0x18, 0x18, 0x66, 0x00, 
  0x06, 0x1b, 0x33, 0x66, 0x66, 0x66, 0x66, 0x00, 0x66, 0x66, 0x66, 0x7e, 0x66, 0x7e, 0x66, 0x00, 
  0x66, 0x18, 0x66, 0x66, 0x66, 0x63, 0x00, 0x00, 0x66, 0x00, 0x60, 0x36, 0x66, 0x18, 0x00, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x18, 0x18, 0x36, 0x00, 0x18, 0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x36, 0x00, 0x36, 0x36, 0x00, 0x36, 0x00, 
  0x00, 0x18, 0x36, 0x00, 0x00, 0x18, 0x36, 0x00, 0x18, 0x00, 0x18, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x63, 0x63, 0x06, 0x36, 0x06, 0x63, 0x66, 0x00, 0x08, 0x63, 0x36, 0x63, 0x00, 0x6b, 0x06, 0x00, 
  0x7e, 0x18, 0x0c, 0x30, 0x18, 0x1b, 0x18, 0x00, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x7e, 0x00, 
  0x00, 0x42, 0x7e, 0x08, 0x08, 0x1c, 0x3e, 0x00, 0xe7, 0x66, 0x00, 0x00, 0x00, 0x0e, 0x67, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x40, 0x60, 0x7e, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 
  0x00, 0x18, 0x00, 0x36, 0x3c, 0x66, 0x33, 0x00, 0x18, 0x18, 0x00, 0x00, 0x18, 0x00, 0x18, 0x06, 
  0x36, 0x18, 0x06, 0x66, 0x30, 0x66, 0x66, 0x18, 0x66, 0x30, 0x18, 0x18, 0x60, 0x00, 0x06, 0x18, 
  0x03, 0x66, 0x66, 0x66, 0x36, 0x06, 0x06, 0x66, 0x66, 0x18, 0x66, 0x63, 0x06, 0x63, 0x63, 0x66, 
  0x06, 0x66, 0x66, 0x66, 0x18, 0x66, 0x18, 0x77, 0xc3, 0x18, 0x06, 0x0c, 0x60, 0x30, 0x00, 0x00, 
  0x00, 0x66, 0x66, 0x66, 0x66, 0x06, 0x0c, 0x66, 0x66, 0x18, 0x30, 0x66, 0x18, 0x6b, 0x66, 0x66, 
  0x66, 0x66, 0x06, 0x60, 0x0c, 0x66, 0x3c, 0x3e, 0x63, 0x66, 0x06, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x66, 0x66, 0x06, 0x66, 0x66, 0x66, 0x66, 0x00, 0x06, 0x06, 0x06, 0x18, 0x18, 0x18, 0x66, 0x00, 
  0x06, 0x1b, 0x33, 0x66, 0x66, 0x66, 0x66, 0x00, 0x66, 0x66, 0x66, 0x7e, 0x66, 0x18, 0xcf, 0x00, 
  0x66, 0x18, 0x66, 0x66, 0x66, 0x63, 0x00, 0x00, 0x66, 0x00, 0x00, 0x66, 0x56, 0x18, 0x00, 0x00, 
  0x11, 0xaa, 0x77, 0x18, 0x18, 0x18, 0x36, 0x00, 0x18, 0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x36, 0x00, 0x36, 0x36, 0x00, 0x36, 0x00, 
  0x00, 0x18, 0x36, 0x00, 0x00, 0x18, 0x36, 0x00, 0x18, 0x00, 0x18, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x73, 0x63, 0x06, 0x36, 0x03, 0x63, 0x66, 0x00, 0x08, 0x63, 0x36, 0x63, 0x00, 0x6b, 0x06, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x18, 0x1b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x00, 0x00, 0x7e, 0x00, 
  0x00, 0x3c, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 
  0x00, 0x00, 0x00, 0x66, 0x70, 0x66, 0x7e, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 
  0x00, 0x18, 0x00, 0x36, 0x18, 0x63, 0x6e, 0x00, 0x18, 0x18, 0x00, 0x00, 0x18, 0x00, 0x18, 0x03, 
  0x1c, 0x7e, 0x7e, 0x3c, 0x30, 0x3c, 0x3c, 0x18, 0x3c, 0x1c, 0x18, 0x18, 0x00, 0x00, 0x00, 0x18, 
  0x3e, 0x66, 0x3e, 0x3c, 0x1e, 0x7e, 0x06, 0x7c, 0x66, 0x7e, 0x3c, 0x63, 0x7e, 0x63, 0x63, 0x3c, 
  0x06, 0x3c, 0x66, 0x3c, 0x18, 0x3c, 0x18, 0x63, 0xc3, 0x18, 0x7e, 0x0c, 0xc0, 0x30, 0x00, 0x00, 
  0x00, 0x7c, 0x3e, 0x3c, 0x7c, 0x3c, 0x0c, 0x7c, 0x66, 0x78, 0x30, 0x66, 0x78, 0x63, 0x66, 0x3c, 
  0x3e, 0x7c, 0x06, 0x3e, 0x78, 0x7c, 0x18, 0x36, 0x63, 0x7c, 0x7e, 0x18, 0x18, 0x0c, 0x00, 0x00, 
  0x3c, 0x7c, 0x3c, 0x7c, 0x7c, 0x7c, 0x7c, 0x00, 0x3c, 0x3c, 0x3c, 0x3c, 0x3c, 0x3c, 0x66, 0x00, 
  0x7e, 0xee, 0xf3, 0x3c, 0x3c, 0x3c, 0x7c, 0x00, 0x7c, 0x3c, 0x3c, 0x18, 0x3f, 0x18, 0x00, 0x00, 
  0x7c, 0x3c, 0x3c, 0x7c, 0x66, 0x63, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x33, 0xf3, 0x18, 0x00, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x18, 0x18, 0x36, 0x00, 0x18, 0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x36, 0x00, 0x36, 0x36, 0x00, 0x36, 0x00, 
  0x00, 0x18, 0x36, 0x00, 0x00, 0x18, 0x36, 0x00, 0x18, 0x00, 0x18, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x6e, 0x33, 0x06, 0x36, 0x7f, 0x3e, 0x3e, 0x00, 0x08, 0x3e, 0x77, 0x3e, 0x00, 0x3e, 0x7c, 0x00, 
  0x00, 0x7e, 0x7e, 0x7e, 0x18, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x7e, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x66, 0x70, 0x3c, 0x7e, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x18, 0x03, 0x00, 0x00, 0x30, 0x0c, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x03, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0xc0, 0x3c, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x06, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00, 0x70, 0x18, 0x07, 0x00, 0x00, 
  0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x73, 0x43, 0x00, 0x00, 0x00, 
  0x11, 0xaa, 0xee, 0x18, 0x18, 0x18, 0x36, 0x00, 0x18, 0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x36, 0x00, 0x36, 0x36, 0x00, 0x36, 0x00, 
  0x00, 0x18, 0x36, 0x00, 0x00, 0x18, 0x36, 0x00, 0x18, 0x00, 0x18, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x06, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x44, 0x55, 0xdb, 0x18, 0x18, 0x18, 0x36, 0x00, 0x18, 0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x36, 0x00, 0x36, 0x36, 0x00, 0x36, 0x00, 
  0x00, 0x18, 0x36, 0x00, 0x00, 0x18, 0x36, 0x00, 0x18, 0x00, 0x18, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x06, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x11, 0xaa, 0x77, 0x18, 0x18, 0x18, 0x36, 0x00, 0x18, 0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x36, 0x00, 0x36, 0x36, 0x00, 0x36, 0x00, 
  0x00, 0x18, 0x36, 0x00, 0x00, 0x18, 0x36, 0x00, 0x18, 0x00, 0x18, 0xff, 0xff, 0x0f, 0xf0, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x00, 0x7f, 0x7f, 
  0x00, 0x7f, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x7f, 0x00, 0x7f, 0x7f, 0x00, 0x00, 0xc0, 0xc0, 0xc0, 
  0x00, 0x7f, 0x7f, 0x7f, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0xff, 0xff, 
  0x00, 0xff, 0x00, 0x00, 0x00, 0xff, 0x00, 0xff, 0x00, 0xff, 0xff, 0x00, 0x00, 0xff, 0xff, 0xff, 
};
int32_t vgatext_start(vgatext *self, int32_t pinbase)
{
  int32_t 	i, pclkscale, pclk, sysclk, x, fontptr;
  // calculate clock frequency
  pclk = VGATEXT_PIXEL_CLOCK_FREQ;
  // system clock
  sysclk = _clkfreq;
  // calculate scale := $8000_0000 * pclk / sysclk
  pclkscale = vgatext_calcscale(pclk, sysclk);
  fontptr = (int32_t)(((char *)&dat[0]));
  if (VGATEXT_FONT_HEIGHT == 15) {
    // skip a row
    fontptr = fontptr + 256;
  }
  i = 0;
  self->params[(i++)] = pinbase;
  // screen buffer
  self->params[(i++)] = (int32_t)(self->screen_buffer);
  // screen columns
  self->params[(i++)] = VGATEXT_COLS;
  // screen rows
  self->params[(i++)] = VGATEXT_ROWS;
  // font data: skip first row
  self->params[(i++)] = fontptr;
  // font width
  self->params[(i++)] = 8;
  // font height
  self->params[(i++)] = VGATEXT_FONT_HEIGHT;
  // fset           ' pixel clock scaling value
  self->params[(i++)] = pclkscale;
  // horizontal front porch
  self->params[(i++)] = 40;
  // hsync pulse
  self->params[(i++)] = 128;
  // horizontal back porch
  self->params[(i++)] = 88;
  // vertical front porch
  self->params[(i++)] = 1;
  // vertical sync lines
  self->params[(i++)] = 4;
  // vertical back porch
  self->params[(i++)] = 23;
  // vertical/horizontal polarity
  self->params[(i++)] = 0;
  self->params[(i++)] = VGATEXT_CELL_SIZE;
  x = vga_tile_driver_start(&self->vga, (int32_t)(self->params));
  vgatext_init_terminal(self);
  return x;
}

void vgatext_stop(vgatext *self)
{
  vga_tile_driver_stop(&self->vga);
}

static void vgatext_init_terminal(vgatext *self)
{
  vgatext_reset_graphics_state(self);
  vgatext_cls(self);
  self->cursor_visible = 0;
  self->cursor_enabled = 1;
  // blinking mask; use $20 for blinking underline
  self->cursor_effect = 16;
  self->curx = self->cury = 0;
  self->state = VGATEXT_STATE_NORMAL;
  self->scroll_first = 0;
  self->scroll_last = VGATEXT_ROWS - 1;
}

static void vgatext_reset_graphics_state(vgatext *self)
{
  self->bgcolor = 0;
  self->fgcolor = ((VGATEXT_CELL_SIZE == 8) ? -256 : 7);
  self->char_effects = 0;
}

static void vgatext_copy_line(vgatext *self, int32_t dest, int32_t src)
{
  int32_t 	linelen;
  linelen = VGATEXT_CELL_SIZE * VGATEXT_COLS;
  dest = ((int32_t)(self->screen_buffer)) + (dest * linelen);
  src = ((int32_t)(self->screen_buffer)) + (src * linelen);
  memcpy( (void *)dest, (void *)src, 1*(linelen));
}

static void vgatext_scroll_up(vgatext *self)
{
  int32_t 	last, i;
  i = self->scroll_first;
  last = self->scroll_last;
  while (i < last) {
    vgatext_copy_line(self, i, i + 1);
    i = i + 1;
  }
  vgatext_clear(self, VGATEXT_COLS * last, (VGATEXT_COLS * (last + 1)) - 1);
}

static void vgatext_scroll_down(vgatext *self)
{
  int32_t 	first, i;
  i = self->scroll_last;
  first = self->scroll_first;
  while (i > first) {
    vgatext_copy_line(self, i, i - 1);
    i = i - 1;
  }
  vgatext_clear(self, VGATEXT_COLS * first, (VGATEXT_COLS * (first + 1)) - 1);
}

static void vgatext_checkposition(vgatext *self)
{
  if (self->curx >= VGATEXT_COLS) {
    self->curx = 0;
    (self->cury++);
  } else {
    if (self->curx < 0) {
      self->curx = 0;
    }
  }
  if (self->cury > VGATEXT_ROWS-1) {
    vgatext_scroll_up(self);
    self->cury = VGATEXT_ROWS-1;
  } else {
    if (self->cury < 0) {
      self->cury = 0;
    }
  }
}

int32_t vgatext_tx(vgatext *self, int32_t c)
{
  int32_t 	fg, bg;
  vgatext_concealcursor(self);
  if (self->state == VGATEXT_STATE_NORMAL) {
    if (c == 8) {
      // backspace
      (--self->curx);
    } else {
      if (c == 10) {
        // line feed
        (self->cury++);
      } else {
        if (c == 13) {
          // carriage return
          self->curx = 0;
        } else {
          if (c == 20) {
            // tab
            self->curx = (self->curx + 8) & ((7 << 24) >> 24);
          } else {
            if (c == 27) {
              self->state = VGATEXT_STATE_ESCAPE;
            } else {
              fg = self->fgcolor;
              bg = self->bgcolor;
              if (self->char_effects & VGATEXT_CHAR_INVERSE) {
                // swap
                { Tuple2__ tmp__ = ((Tuple2__){bg, fg}); fg = tmp__.v0; bg = tmp__.v1;  };
              }
              vgatext_checkposition(self);
              vgatext_glyphat(self, self->curx, self->cury, c, fg, bg, self->char_effects & 0xff);
              (self->curx++);
            }
          }
        }
      }
    }
  } else {
    if (self->state == VGATEXT_STATE_ESCAPE) {
      vgatext_handle_esc(self, c);
    } else {
      if (self->state == VGATEXT_STATE_START_CSI) {
        vgatext_handle_csi_start(self, c);
      } else {
        if (self->state == VGATEXT_STATE_IN_CSI) {
          vgatext_handle_csi(self, c);
        } else {
          if (self->state == VGATEXT_STATE_IN_PRIV) {
            vgatext_handle_priv(self, c);
          }
        }
      }
    }
  }
  vgatext_revealcursor(self);
  return 1;
}

static void vgatext_handle_esc(vgatext *self, int32_t c)
{
  int32_t 	i;
  if (c == '[') {
    for(i = 0; i < VGATEXT_MAX_ESC_ARGS; i++) {
      self->args[i] = 0;
    }
    self->argidx = 0;
    self->state = VGATEXT_STATE_START_CSI;
  } else {
    if (c == 'D') {
      vgatext_scroll_down(self);
    } else {
      if (c == 'M') {
        vgatext_scroll_up(self);
      } else {
        if (c == 'c') {
          vgatext_init_terminal(self);
        } else {
          self->state = VGATEXT_STATE_NORMAL;
        }
      }
    }
  }
}

static int32_t vgatext_defaultval(int32_t arg, int32_t v)
{
  return ((arg) ? arg : v);
}

// first character of control sequence
// if it is '?' it's a private control sequence
static void vgatext_handle_csi_start(vgatext *self, int32_t c)
{
  if (c == '?') {
    self->state = VGATEXT_STATE_IN_PRIV;
  } else {
    self->state = VGATEXT_STATE_IN_CSI;
    vgatext_handle_csi(self, c);
  }
}

// handle ANSI control sequences
static void vgatext_handle_csi(vgatext *self, int32_t c)
{
  if ((c >= '0') && (c <= '9')) {
    self->args[self->argidx] = (10 * self->args[self->argidx]) + (c - '0');
    return;
  }
  (self->argidx++);
  if (self->argidx == VGATEXT_MAX_ESC_ARGS) {
    (--self->argidx);
  }
  if (c == ';') {
    return;
  }
  if (c == 'A') {
    self->cury = self->cury - vgatext_defaultval(self->args[0], 1);
  } else {
    if (c == 'B') {
      self->cury = self->cury + vgatext_defaultval(self->args[0], 1);
    } else {
      if (c == 'C') {
        self->curx = self->curx + vgatext_defaultval(self->args[0], 1);
      } else {
        if (c == 'D') {
          self->curx = self->curx - vgatext_defaultval(self->args[0], 1);
        } else {
          if (c == 'E') {
            self->cury = self->cury + vgatext_defaultval(self->args[0], 1);
            self->curx = 0;
          } else {
            if (c == 'F') {
              self->cury = self->cury - vgatext_defaultval(self->args[0], 1);
              self->curx = 0;
            } else {
              if (c == 'G') {
                self->curx = vgatext_defaultval(self->args[0], 1) - 1;
              } else {
                if (c == 'H') {
                  self->cury = vgatext_defaultval(self->args[0], 1) - 1;
                  self->curx = vgatext_defaultval(self->args[1], 1) - 1;
                } else {
                  if (c == 'J') {
                    vgatext_clear_in_display(self, vgatext_defaultval(self->args[0], 0));
                  } else {
                    if (c == 'K') {
                      vgatext_clear_in_line(self, vgatext_defaultval(self->args[0], 0));
                    } else {
                      if (c == 'm') {
                        vgatext_set_graphic_rendition(self, 0);
                      } else {
                        if (c == 'r') {
                            self->scroll_first = vgatext_defaultval(self->args[0], 1) - 1;
                            self->scroll_last = vgatext_defaultval(self->args[1], VGATEXT_ROWS) - 1;
                        } if (c == 's') {
                          self->savex = self->curx;
                          self->savey = self->cury;
                        } else {
                          if (c == 'u') {
                            self->curx = self->savex;
                            self->cury = self->savey;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  self->state = VGATEXT_STATE_NORMAL;
}

// handle private escape sequence
static void vgatext_handle_priv(vgatext *self, int32_t c)
{
  int32_t 	a;
  if ((c >= '0') && (c <= '9')) {
    self->args[self->argidx] = (10 * self->args[self->argidx]) + (c - '0');
    return;
  }
  (self->argidx++);
  if (self->argidx == VGATEXT_MAX_ESC_ARGS) {
    (--self->argidx);
  }
  if (c == ';') {
    return;
  }
  if (c == 'h') {
    a = vgatext_defaultval(self->args[0], 1);
    if (a == 25) {
      self->cursor_enabled = 1;
    }
  } else {
    if (c == 'l') {
      a = vgatext_defaultval(self->args[0], 1);
      if (a == 25) {
        self->cursor_enabled = 0;
      }
    }
  }
  self->state = VGATEXT_STATE_NORMAL;
}

//  
// possible effects:
// $01 = solid mask
// $02 = underline
// $04 = strikethrough
// $08 = reserved
// $10 = blinking mask
// $20 = blinking underline
// $40 = blinking strikethrough
// $80 = reserved
// these are stored in the lower 8 bits of the char_effects variable
//
void vgatext_glyphat(vgatext *self, int32_t x, int32_t y, int32_t ch, int32_t fgcol, int32_t bgcol, int32_t effect)
{
  int32_t 	bufptr;
  bufptr = (int32_t)(self->screen_buffer);
  if (VGATEXT_CELL_SIZE == 8) {
    bufptr = bufptr + (((y * VGATEXT_COLS) + x) * 8);
    fgcol |= (ch & 0xff);
    bgcol |= (effect & 0xff);
    ((int32_t *)bufptr)[0] = fgcol;
    bufptr = bufptr + 4;
    ((int32_t *)bufptr)[0] = bgcol;
  } else {
    fgcol = ((fgcol | (bgcol << 8)) | ((ch & 0xff) << 16)) | ((effect & 0xff) << 24);
    bufptr = bufptr + (((y * VGATEXT_COLS) + x) * 4);
    ((int32_t *)bufptr)[0] = fgcol;
  }
}

static int32_t vgatext_setcursorvisible(vgatext *self, int32_t yesno)
{
  int32_t 	bufptr, x, y;
  if (self->cursor_visible == yesno) {
    return yesno;
  }
  // if asking to turn on the cursor, but it is
  // disabled, ignore the request
  if ((yesno) && (!(self->cursor_enabled))) {
    return 0;
  }
  // change cursor state
  self->cursor_visible = yesno;
  bufptr = (int32_t)(self->screen_buffer);
  // restrict x to be between 0 and COLS-1
  x = self->curx;
  y = self->cury;
  x = Min__((Max__(0, x)), (VGATEXT_COLS - 1));
  y = Min__((Max__(0, y)), (VGATEXT_ROWS - 1));
  bufptr = bufptr + (((y * VGATEXT_COLS) + x) * VGATEXT_CELL_SIZE);
  if (VGATEXT_CELL_SIZE == 8) {
    bufptr = bufptr + 4;
  } else {
    bufptr = bufptr + 3;
  }
  x = ((char *)bufptr)[0];
  if (self->cursor_visible) {
    self->saved_cursor_data = x;
    x |= self->cursor_effect;
    // turn off bg color blink
    x &= 0x7f;
  } else {
    x = self->saved_cursor_data;
  }
  ((char *)bufptr)[0] = x;
  // return old cursor state
  return ((yesno) ? 0 : 1);
}

static void vgatext_concealcursor(vgatext *self)
{
  vgatext_setcursorvisible(self, 0);
}

static void vgatext_revealcursor(vgatext *self)
{
  vgatext_setcursorvisible(self, self->cursor_enabled);
}

// globals: force cursor on or off
void vgatext_showcursor(vgatext *self)
{
  self->cursor_enabled = 1;
  vgatext_setcursorvisible(self, self->cursor_enabled);
}

void vgatext_hidecursor(vgatext *self)
{
  self->cursor_enabled = 0;
  vgatext_setcursorvisible(self, 0);
}

void vgatext_cls(vgatext *self)
{
  vgatext_clear(self, 0, (VGATEXT_COLS * VGATEXT_ROWS) - 1);
}

// clear from position a to position b (inclusive)
// a and b are in character offsets (so they have to be scaled appropriately)
static void vgatext_clear(vgatext *self, int32_t a, int32_t b)
{
  int32_t 	ptr, cnt, temp;
  ptr = ((int32_t)(self->screen_buffer)) + (VGATEXT_CELL_SIZE * a);
  cnt = b - a;
  if (VGATEXT_CELL_SIZE == 4) {
    temp = self->fgcolor | (self->bgcolor << 8);
    while (cnt >= 0) {
      ((int32_t *)ptr)[0] = temp;
      ptr = ptr + 4;
      (--cnt);
    }
  } else {
    while (cnt >= 0) {
      ((int32_t *)ptr)[0] = self->fgcolor;
      ptr = ptr + 4;
      ((int32_t *)ptr)[0] = self->bgcolor;
      ptr = ptr + 4;
      (--cnt);
    }
  }
}

// clear from cursor to end of display (if n==0) or from start of screen to cursor (n == 1)
// n==2 clears whole display and resets cursor to top
static void vgatext_clear_in_display(vgatext *self, int32_t n)
{
  int32_t 	startpix, endpix;
  if (n == 2) {
    self->curx = self->cury = 0;
    n = 0;
  }
  if (n == 1) {
    startpix = 0;
    endpix = (VGATEXT_COLS * self->cury) + self->curx;
  } else {
    startpix = (VGATEXT_COLS * self->cury) + self->curx;
    endpix = (VGATEXT_COLS * VGATEXT_ROWS) - 1;
  }
  vgatext_clear(self, startpix, endpix);
}

static void vgatext_clear_in_line(vgatext *self, int32_t n)
{
  int32_t 	startpix, endpix;
  if (n == 2) {
    self->curx = 0;
    n = 0;
  }
  if (n == 1) {
    startpix = VGATEXT_COLS * self->cury;
    endpix = (VGATEXT_COLS * self->cury) + self->curx;
  } else {
    startpix = (VGATEXT_COLS * self->cury) + self->curx;
    endpix = (VGATEXT_COLS * (self->cury + 1)) - 1;
  }
  vgatext_clear(self, startpix, endpix);
}

// get an argument that's already been set up, return -1 if not valid
static int32_t vgatext_fetcharg(vgatext *self, int32_t i)
{
  if (i >= self->argidx) {
    return (-1);
  }
  return self->args[i];
}

static void vgatext_set_graphic_rendition(vgatext *self, int32_t i)
{
  int32_t 	code, _tmp__0001;
  if (i > self->argidx) {
    return;
  }
  code = vgatext_fetcharg(self, i++);
  /*   
    a := hexdig(code & $F)
    b := hexdig((code >> 4) & $F)
    glyphat(41, 10, b, $ffffff00, $00202000)
    glyphat(42, 10, a, $ffffff00, $00202000)
    pausems(1000)
   */
  _tmp__0001 = code;
  if (_tmp__0001 == 0) {
    goto _case__0003;
  }
  if (_tmp__0001 == 1) {
    goto _case__0004;
  }
  if (_tmp__0001 == 4) {
    goto _case__0005;
  }
  if (_tmp__0001 == 5) {
    goto _case__0006;
  }
  if (_tmp__0001 == 7) {
    goto _case__0007;
  }
  if (_tmp__0001 == 8) {
    goto _case__0008;
  }
  if (_tmp__0001 == 9) {
    goto _case__0009;
  }
  if (_tmp__0001 == 21) {
    goto _case__0010;
  }
  if (_tmp__0001 == 22) {
    goto _case__0011;
  }
  if (_tmp__0001 == 24) {
    goto _case__0012;
  }
  if (_tmp__0001 == 27) {
    goto _case__0013;
  }
  if (_tmp__0001 == 28) {
    goto _case__0014;
  }
  if (_tmp__0001 == 29) {
    goto _case__0015;
  }
  if ((_tmp__0001 >= 30) && (_tmp__0001 <= 37)) {
    goto _case__0016;
  }
  if (_tmp__0001 == 38) {
    goto _case__0017;
  }
  if (_tmp__0001 == 39) {
    goto _case__0018;
  }
  if ((_tmp__0001 >= 40) && (_tmp__0001 <= 47)) {
    goto _case__0019;
  }
  if (_tmp__0001 == 48) {
    goto _case__0020;
  }
  if (_tmp__0001 == 49) {
    goto _case__0021;
  }
  goto _endswitch_0002;
  _case__0003:
  vgatext_reset_graphics_state(self);
  goto _endswitch_0002;
  _case__0004:
  self->char_effects |= VGATEXT_CHAR_BOLD;
  goto _endswitch_0002;
  _case__0005:
  self->char_effects |= VGATEXT_CHAR_UNDERLINE;
  goto _endswitch_0002;
  _case__0006:
  self->char_effects |= (VGATEXT_CHAR_BLINK_HIDDEN | VGATEXT_CHAR_BLINK_BG);
  goto _endswitch_0002;
  _case__0007:
  self->char_effects |= VGATEXT_CHAR_INVERSE;
  goto _endswitch_0002;
  _case__0008:
  self->char_effects |= VGATEXT_CHAR_HIDDEN;
  goto _endswitch_0002;
  _case__0009:
  self->char_effects |= VGATEXT_CHAR_STRIKETHRU;
  goto _endswitch_0002;
  _case__0010:
  self->char_effects &= (~VGATEXT_CHAR_BOLD);
  goto _endswitch_0002;
  _case__0011:
  self->char_effects &= (~VGATEXT_CHAR_BOLD);
  goto _endswitch_0002;
  _case__0012:
  self->char_effects &= (~VGATEXT_CHAR_UNDERLINE);
  goto _endswitch_0002;
  _case__0013:
  self->char_effects &= (~VGATEXT_CHAR_INVERSE);
  goto _endswitch_0002;
  _case__0014:
  self->char_effects &= (~VGATEXT_CHAR_HIDDEN);
  goto _endswitch_0002;
  _case__0015:
  self->char_effects &= (~VGATEXT_CHAR_STRIKETHRU);
  goto _endswitch_0002;
  _case__0016:
  self->fgcolor = vgatext_ansicolor(self, code - 30);
  goto _endswitch_0002;
  _case__0017:
  { Tuple2__ tmp__ = vgatext_getargcolor(self, i); self->fgcolor = tmp__.v0; i = tmp__.v1;  };
  goto _endswitch_0002;
  _case__0018:
  self->fgcolor = VGATEXT_DEFAULT_FG_COLOR;
  goto _endswitch_0002;
  _case__0019:
  self->bgcolor = vgatext_ansicolor(self, code - 40);
  goto _endswitch_0002;
  _case__0020:
  { Tuple2__ tmp__ = vgatext_getargcolor(self, i); self->bgcolor = tmp__.v0; i = tmp__.v1;  };
  goto _endswitch_0002;
  _case__0021:
  self->bgcolor = VGATEXT_DEFAULT_BG_COLOR;
  goto _endswitch_0002;
  _endswitch_0002:
  vgatext_set_graphic_rendition(self, i);
}

// look up an ANSI color from the color table
static int32_t vgatext_ansicolor(vgatext *self, int32_t n)
{
  int32_t 	ptr;
  if (self->char_effects & VGATEXT_CHAR_BOLD) {
    n |= 0x8;
  }
  if (VGATEXT_CELL_SIZE == 4) {
    return n;
  }
  ptr = (int32_t)(((int32_t *)&dat[4096]));
  return ((int32_t *)(ptr + (4 * n)))[0];
}

// calculate an RGB color from a 6,6,6 encoded 8 bit color
static int32_t vgatext_sixcolor(int32_t x)
{
  int32_t 	r, g, b;
  b = x % 6;
  x = x / 6;
  g = x % 6;
  r = x / 6;
  r = (255 * r) / 6;
  g = (255 * g) / 6;
  b = (255 * b) / 6;
  return (((r << 24) | (g << 16)) | b);
}

// calculate a color value from an r,g,b triple
int32_t vgatext_getrgbcolor(int32_t r, int32_t g, int32_t b)
{
  if (VGATEXT_CELL_SIZE == 4) {
    r = ((16 + (36 * (r / 51))) + (6 * (g / 51))) + (b / 51);
  } else {
    r = ((r << 24) | (g << 16)) | (b << 8);
  }
  return r;
}

// get a color out of arguments
static Tuple2__ vgatext_getargcolor(vgatext *self, int32_t i)
{
  int32_t 	r, g, b, code;
  code = vgatext_fetcharg(self, i++);
  if (code == 0) {
    return ((Tuple2__){0, i});
  }
  if (code == 2) {
    r = vgatext_fetcharg(self, i++) & 0xff;
    g = vgatext_fetcharg(self, i++) & 0xff;
    b = vgatext_fetcharg(self, i++) & 0xff;
    r = vgatext_getrgbcolor(r, g, b);
    return ((Tuple2__){r, i});
  }
  if (code == 5) {
    r = vgatext_fetcharg(self, i++) & 0xff;
    if (VGATEXT_CELL_SIZE == 4) {
      return ((Tuple2__){r, i});
    } else {
      if (r <= 15) {
        r = ((int32_t *)&dat[4096])[r];
      } else {
        if (r >= 232) {
          r = 10 * (r - 232);
          r = r + 8;
          return ((Tuple2__){((r << 24) | (r << 16)) | (r << 8), i});
        } else {
          r = vgatext_sixcolor(r);
          return ((Tuple2__){r, i});
        }
      }
    }
  }
  // punt for now
  return ((Tuple2__){0, i});
}

static int32_t vgatext_calcscale(int32_t a, int32_t b)
{
  int32_t 	shiftcnt;
  shiftcnt = VGATEXT_PIXSHIFT;
  // remove factors of 5 (will be pretty common)
  while ((0 == (a % 5)) && (0 == (b % 5))) {
    a = a / 5;
    b = b / 5;
  }
  // scale a up as much as we can
  while (((a & 0x40000000) == 0) && (shiftcnt > 0)) {
    a = a << 1;
    (shiftcnt--);
  }
  while (((b & 0x1) == 0) && (shiftcnt > 0)) {
    b = Shr__(b, 1);
    (shiftcnt--);
  }
  return ((a / b) << shiftcnt);
}

void vgatext_str(vgatext *self, const char *s)
{
  int32_t 	c;
  while ((c = (s++)[0]) != 0) {
    vgatext_tx(self, c);
  }
}

// print a newline
void vgatext_nl(vgatext *self)
{
  vgatext_tx(self, 13);
  vgatext_tx(self, 10);
}

